<!--src/pages/admin/[edit]/[id].astro-->
---
import Base from "../../../layouts/admin/Base.astro"
import Post from "../../../layouts/admin/Post.astro"
const { userAuth, prisma, setting } = Astro.locals
if(!userAuth?.userId){ return Astro.redirect('/login') }

const { type } = Astro.params
const params = Astro.params
//const rawModule = await import(`../../../data/${type}`)
//const module = rawModule.default
import module from `../../../data/post.js`

const total = await module.count({prisma})
const items = await module.getItems({prisma}, setting.adminItems)
const items_ = items.map((item)=>{item.date = new Date(item.date).toLocaleDateString('it-IT');
                                return item })
const item_ = await module.getItem({prisma, params})
---

<Base pageTitle="ទំព័រ​គ្រប់គ្រង" total={total} items={items_} type={type}>
    <Post item={item_} type={type}/>
</Base>